{"version":3,"names":["loaderScript","document","getElementById","configUrl","getAttribute","bundle","loadController","controllerOptions","controllerPath","params","JSON","parse","err","window","require","controller","startController","started","start","addEventListener","readyState","loadBundles","loaded","bundles","concat","filter","item","index","indexOf","forEach","length","define","_","appController","request","containerFactory","breadcrumbsFactory","urlHelper","getRoutes","route","routes","parsed","knownRoutes","knownRoute","url","path","push","param","query","decodeURIComponent","build","breadcrumbsUrl","indexUrl","monitorUrl","historyUrl","defaults","toolbox","breadcrumbs","renderTo","getElement","replace","cls","on","parsedRoute","location","then","data","update","catch","onError","apply"],"sources":["/github/workspace/tao/views/build/config-wrap-start-default.js","../../loader/bootstrap.js","../controller/app.js","module-create.js","/github/workspace/tao/views/build/config-wrap-end-default.js"],"sourcesContent":["\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016-2018 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * Bootstrap the app, start the entry controller\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\n(function(){\n    'use strict';\n\n\n\n    var loaderScript = document.getElementById('amd-loader');\n    var configUrl = loaderScript.getAttribute('data-config');\n    var bundle  = loaderScript.getAttribute('data-bundle');\n\n    var loadController = function loadController(){\n        var controllerOptions = {};\n        var controllerPath = loaderScript.getAttribute('data-controller');\n        var params = loaderScript.getAttribute('data-params');\n        try{\n            controllerOptions = JSON.parse(params);\n        } catch(err){\n            controllerOptions = {};\n        }\n        window.require([controllerPath], function(controller) {\n            var startController = function startController(){\n                if(!window.started){\n                    window.started = true;\n                    controller.start(controllerOptions);\n                }\n            };\n            document.addEventListener('readystatechange', startController, false);\n            if (document.readyState === 'complete') {\n                startController();\n            }\n        });\n    };\n\n    //always start to load the config\n    window.require([configUrl], function() {\n\n        //define the global loading mechanism\n        if(!window.loadBundles){\n            //keep tracl of loaded bundles, even if require does it,\n            //this prevent some unecessary cycles\n            window.loaded = {};\n\n            /**\n             * Loading entry point for inter bundle dependency,\n             * always take the bundles from the params and window.bundles\n             * @param {String[]} [bundles] - an optional list of bundle to load\n             */\n            window.loadBundles = function loadBundles(bundles){\n                bundles = bundles || [];\n                bundles = bundles.concat(window.bundles)\n                bundles = bundles.filter( function(item, index){\n                    return item && bundles.indexOf(item) === index && window.loaded[item] !== true;\n                });\n                require(bundles, function(){\n                    bundles.forEach( function( item ) {\n                        window.loaded[item] = true;\n                    });\n                    loadController();\n                });\n            }\n        }\n\n        if(bundle || (window.bundles && window.bundles.length)) {\n            window.loadBundles([bundle]);\n        } else {\n            loadController();\n        }\n    });\n})();\n\ndefine(\"loader/bootstrap\", function(){});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-SÃ©bastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoProctoring/controller/app',[\n    'lodash',\n    'controller/app',\n    'core/dataProvider/request',\n    'ui/container',\n    'ui/breadcrumbs',\n    'util/url'\n], function (_, appController, request, containerFactory, breadcrumbsFactory, urlHelper) {\n    'use strict';\n\n    var breadcrumbsUrl = urlHelper.route('load', 'Breadcrumbs', 'tao');\n    var indexUrl = urlHelper.route('index', 'DeliverySelection', 'taoProctoring');\n    var monitorUrl = urlHelper.route('index', 'Monitor', 'taoProctoring');\n    var historyUrl = urlHelper.route('index', 'Reporting', 'taoProctoring');\n    var knownRoutes = [{\n        url: indexUrl,\n        params: ['context']\n    }, {\n        url: monitorUrl,\n        params: ['delivery', 'context']\n    }, {\n        url: historyUrl,\n        params: ['delivery', 'session', 'context']\n    }];\n\n    /**\n     * Gets the list of routes that lead to the provided route\n     * @param {String} route\n     * @returns {String[]}\n     */\n    function getRoutes(route) {\n        var routes = [];\n        var parsed = urlHelper.parse(route);\n\n        _.forEach(knownRoutes, function (knownRoute) {\n            var url = urlHelper.parse(knownRoute.url);\n            var params = {};\n\n            if (parsed.path === url.path) {\n                routes.push(route);\n                return false;\n            }\n\n            _.forEach(knownRoute.params, function (param) {\n                if (parsed.query[param]) {\n                    params[param] = decodeURIComponent(parsed.query[param]);\n                }\n            });\n\n            routes.push(urlHelper.build(knownRoute.url, params));\n        });\n        return routes;\n    }\n\n    /**\n     * The app controller takes care of the application navigation and routing.\n     */\n    return _.defaults({\n        /**\n         * App controller entry point: set up the router.\n         */\n        start: function start() {\n            var toolbox = containerFactory('.header');\n            var breadcrumbs = breadcrumbsFactory({\n                renderTo: toolbox.getElement(),\n                replace: true,\n                cls: 'action-bar horizontal-action-bar'\n            });\n\n            appController\n                .on('change.breadcrumbs', function (route) {\n                    var parsedRoute = urlHelper.parse(route);\n                    var routes = getRoutes(route);\n\n                    if (parsedRoute.query['link-type'] !== undefined && parsedRoute.query['link-type'] === 'direct') {\n                        delete parsedRoute.query['link-type'];\n                        window.location.replace(decodeURIComponent(urlHelper.build(parsedRoute.path, parsedRoute.query)));\n                    }\n                    else {\n                        request(breadcrumbsUrl, {route: routes}, 'POST')\n                            .then(function (data) {\n                                breadcrumbs.update(data);\n                            })\n                            .catch(function (err) {\n                                appController.onError(err);\n                            });\n                    }\n                })\n                .apply('a', toolbox.getElement())\n                .start();\n        }\n    }, appController);\n});\n\n","\ndefine(\"taoProctoring/loader/app.bundle\", function(){});\n","window.bundles = (window.bundles || []).concat([\"taoQtiItem/loader/taoQtiItem.min\",\"taoItems/loader/taoItems.min\",\"taoQtiTest/loader/taoQtiTest.min\"]);\n"],"mappings":"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"}